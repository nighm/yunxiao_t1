作者：娄武剑
日期：20230927

工具名称：云效自动化标注工具

【工具功能介绍】
1、可根据产品名称，在云效用例库（包括：BIOS、BMC、昆仑卫士、机房管理系统）中对测试用例的自动化类型标记（例如：是或否）；
2、根据测试结果标注表格内容自动标记云效测试计划中的用例执行结果（例如：已通过、未通过）；
3、自动导出云效测试计划执行结果（内容包括：编号、标题、测试用例编号、重要级别、自动化类型、执行人、状态、是否提单、问题单号、备注的动态内容）；
4、根据测试计划用例挑选.xlsx文件，在云效上给指定的测试计划添加用例。

【工具操作方法】
此工具为python脚本，需在python3环境中运行，运行前需先配置参数
1、工具包中“automaticLabeling.py”文件为工具可执行脚本，在python3环境中运行即可，可将云效自动化标注工具文件夹放在自动化测试工具的auto_platform目录下（一般使用pycharm运行，重要的操作excel库openpyxl，如没有需提前安装，命令 pip install openpyxl -i https://mirrors.aliyun.com/pypi/simple/）；
2、工具包中“yxConfig.py”文件为参数配置文件，在配置文件中填写自己的云效用户名、密码及其他参数；
3、工具包中“自动化类型标注.csv”文件为自己维护产品的自动化用例库，严格按照文件中模版格式填写（共3列）；
4、工具包中“自动化结果标注.csv”文件为自己执行的测试用例执行结果，严格按照文件中模版格式填写（共3列）；
5、工具包中“测试计划用例挑选.xlsx”文件为测试计划用例挑选的参考文件，内容参考模版自行维护（“测试用例编号”和测试计划名称为自动化执行的必填内容，只挑选“测试用例编号”不为空且指定的测试计划列为“是”的用例）；
6、工具包中"output"文件夹为执行完成输出的一些日志文件；
	①labelAuto文件夹中存放 自动化类型标注结束后未标注或标注错误的日志；
	②logs文件夹中存放Debug日志；
	③resultAuto文件夹中存放 自动化结果标注结束后未标注或标注错误的日志；
	④planCaseAuto文件夹中存放 测试计划用例导出模式导出的测试结果记录表；
	⑤selectCaseAuto文件夹中存放 测试计划用例挑选模式中未找到和重复挑选的用例记录。

7、自动化类型标注模式
	根据产品名称标记自动化用例库中的自动化类型：需修改配置文件
	①autoLabel = 'autoType' 	为对自动化类型的标注；
	②yxProductName = '02_BMC' 	为配置用例库名称；			
	③lineNum = "all" 	为读取“自动化类型标注.csv”文件中的全部用例在云效上进行标注；如果 lineNum = "113"为读取自动化类型标注.csv”中的第113行的用例在云效上进行标注；如果读取多行进行标记使用逗号隔开，例如： lineNum =“113,174,187”。
8、用例执行结果标注模式
	根据测试计划名称对测试用例执行结果进行标注：需修改配置文件
	①autoLabel = 'autoResult'	 为读取“自动化结果标注.csv”文件中的内容在云效上进行自动化结果标注；
	②autoPlanName = "[BMC-AORUN-ZX1000]B019"	为配置云效测试计划名称，只能填一个计划名称：例如名称为：[BMC-AORUN-ZX1000]B019。
9、测试计划用例导出模式
	根据测试计划名称导出所有用例执行结果：需修改配置文件
	①autoLabel = 'getPlanCase'；
	②autoPlanName = "[BMC-AORUN-ZX1000]B019"	导出单个测试计划：例如名称为：[BMC-AORUN-ZX1000]B019
						导出多个测试计划，名称之间用逗号隔开：例如名称为：[BMC-AORUN-ZX1000]B019,[BMC-AORUN-ZX1000]B020
10、测试计划用例挑选模式
	根据测试计划名称导出所有用例执行结果：需修改配置文件
	①autoLabel = 'selectCase'；
	②yxProductName = '02_BMC' 	为产品用例库名称；
	③autoPlanName = "[BMC-AORUN-ZX1000]B019"	计划挑选用例的测试计划名称，只能填一个计划名称：例如：[BMC-AORUN-ZX1000]B019
	④测试计划用例挑选.xlsx	根据此文件中测试用例编号或者编号且同时对应测试计划名称列为“是”的用例为依据将用例导入测试单中

11、测试计划用例引用模式
	将旧的测试计划中待测试、暂缓、未通过的用例，引入到新的测试计划中：需修改配置文件
	①autoLabel = 'quoteCase'；
	②yxProductName = '02_BMC' 	为产品用例库名称；
	③autoPlanName = "[BMC-AORUN-ZX1000]B019"	旧的测试计划名称，只能填一个计划名称：例如：[BMC-AORUN-ZX1000]B019
	④newPlanName = "[BMC-Pengzu-ZX1000]B020"	新的测试计划名称，只能填一个计划名称：例如：[BMC-AORUN-ZX1000]B020
						

修改记录：
20230728		初稿，功能：1、自动化类型标注，2、自动化结果标注；
20230818		修复部分稳定性Bug；
20230831		增加功能：3、测试计划用例导出；
20230907		修复：缺陷显示框内容不可见时点击无法跳转的问题；
20230908		修改：测试计划用例导出表格由xls格式修改为xlsx格式；
20230911		修改：xlwt库只支持xls格式，替换为openpyxl库，用于支持xlsx格式，openpyxl库安装命令：pip install openpyxl -i https://mirrors.aliyun.com/pypi/simple/；
20230918		修复Bug：模块用例超过50个，且出现多个暂缓时xpath变化的问题；
20230925		修改：优化部分元素定位，合入缺陷点击优化和大用例模块暂缓时未跳出的问题，优化1080P 125%缩放时点击目录出错的问题；
20230927		增加功能：4、测试计划用例挑选；
20231103		修改：①出现登录验证滑块时可自动滑动，无需手动（成功率90%+）②优化结果标记方式，增加效率 ③优化1080P 125%缩放时的部分问题；
20231214  	优化： 导出用例时增加判断测试单中有不同产品用例库；
20240318  	优化： 增加挑选用例时的搜索模式--云效编号或用例标题（原因：云效更新），测试计划用例挑选.xlsx 中增加列“编号”；
20240326  	增加功能： 增加测试用例引用模式；
20240511 		优化功能： 适配，云效更新导致的挑选用例模式选择用例库后没用例显示的问题；
20240522 		优化功能： 挑选用例模式测试单用例为空时增加判断；
20240709		修复Bug： 挑选用例模式，云效编号筛选出多个用例时，可精准选择特定用例。
20241021		修复Bug： 优化用例导出模式，适配超多失败用例及暂缓用例导出的情况。
