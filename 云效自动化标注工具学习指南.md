# 云效自动化标注工具学习指南

## 1. 项目概述

云效自动化标注工具是一个基于 Python 和 Selenium 的自动化测试工具，主要用于阿里云云效平台的测试用例管理和标注工作。该工具能够自动完成测试用例的类型标注、结果标注、用例导出和用例挑选等工作，大大提高了测试效率。

## 2. 主要功能

### 2.1 自动化类型标注
- 功能：根据产品名称，在云效用例库中对测试用例进行自动化类型标记
- 支持产品：BIOS、BMC、昆仑卫士、机房管理系统
- 标记方式：是/否
- 配置文件：`自动化类型标注.csv`

### 2.2 自动化结果标注
- 功能：根据测试结果标注表格内容自动标记云效测试计划中的用例执行结果
- 支持结果：已通过、未通过等
- 配置文件：`自动化结果标注.csv`

### 2.3 测试计划用例导出
- 功能：自动导出云效测试计划执行结果
- 导出内容：
  - 编号
  - 标题
  - 测试用例编号
  - 重要级别
  - 自动化类型
  - 执行人
  - 状态
  - 是否提单
  - 问题单号
  - 备注

### 2.4 测试计划用例挑选
- 功能：根据指定文件，在云效上给测试计划添加用例
- 配置文件：`测试计划用例挑选.xlsx`

### 2.5 测试计划用例引用
- 功能：将旧的测试计划中待测试、暂缓、未通过的用例，引入到新的测试计划中

## 3. 技术架构

### 3.1 主要技术栈
- Python 3.x
- Selenium WebDriver
- ChromeDriver
- OpenPyXL（Excel 处理）
- CSV 文件处理

### 3.2 核心模块
```python
class automaticLabeling():
    def __init__(self):
        # 初始化浏览器驱动
        self.driver = webdriver.Chrome()
        
    def login(self):
        # 登录云效平台
        
    def labelAuto(self):
        # 自动化类型标注
        
    def resultAuto(self):
        # 自动化结果标注
        
    def getCase(self):
        # 获取测试用例
        
    def selectCaseMode(self):
        # 测试计划用例挑选
        
    def action(self):
        # 执行主函数
```

## 4. 配置说明

### 4.1 配置文件 (yxConfig.py)
```python
# 基本配置
userName = '用户名'
password = '密码'

# 运行模式
autoLabel = 'autoType'  # 可选值：
# - autoType: 自动化类型标注
# - autoResult: 自动化结果标注
# - getPlanCase: 测试计划用例导出
# - selectCase: 测试计划用例挑选
# - quoteCase: 测试计划用例引用

# 产品配置
yxProductName = '02_BMC'  # 产品名称

# 测试计划配置
autoPlanName = "[BMC-DIKU-ZX]B007"  # 测试计划名称
newPlanName = "[BMC-DIKU-ZX]B007"   # 新测试计划名称

# 用例配置
lineNum = "all"  # 全部标记或指定行号
```

### 4.2 输入文件格式
1. 自动化类型标注.csv
   - 3列格式
   - 包含用例编号和类型信息

2. 自动化结果标注.csv
   - 3列格式
   - 包含用例编号和结果信息

3. 测试计划用例挑选.xlsx
   - 包含测试用例编号
   - 测试计划名称列
   - 编号列（可选）

## 5. 使用流程

### 5.1 环境准备
1. 安装 Python 3.x
2. 安装依赖包：
   ```bash
   pip install selenium openpyxl -i https://mirrors.aliyun.com/pypi/simple/
   ```
3. 配置 ChromeDriver
4. 准备输入文件

### 5.2 运行步骤
1. 修改 yxConfig.py 配置文件
2. 准备相应的输入文件
3. 运行 automaticLabeling.py
4. 查看输出结果

### 5.3 输出文件
- labelAuto/：自动化类型标注日志
- logs/：调试日志
- resultAuto/：自动化结果标注日志
- planCaseAuto/：测试计划用例导出结果
- selectCaseAuto/：测试计划用例挑选日志

## 6. 注意事项

1. 网络要求
   - 确保稳定的网络连接
   - 能够访问云效平台

2. 浏览器要求
   - Chrome 浏览器
   - 匹配版本的 ChromeDriver

3. 文件格式
   - 严格按照模板格式准备输入文件
   - 确保文件编码正确

4. 运行环境
   - 建议使用 PyCharm 运行
   - 确保 Python 环境配置正确

## 7. 常见问题

1. 登录问题
   - 检查用户名密码是否正确
   - 确认网络连接正常
   - 查看是否有验证码

2. 文件处理问题
   - 检查文件格式是否正确
   - 确认文件编码
   - 验证文件内容完整性

3. 浏览器驱动问题
   - 确保 ChromeDriver 版本匹配
   - 检查浏览器版本
   - 确认驱动路径正确

## 8. 更新历史

- 2023-07-28：初版发布
- 2023-08-18：修复稳定性问题
- 2023-08-31：增加测试计划用例导出功能
- 2023-09-27：增加测试计划用例挑选功能
- 2023-11-03：优化登录验证和结果标记
- 2023-12-14：优化导出功能
- 2024-03-18：增加搜索模式
- 2024-03-26：增加用例引用功能
- 2024-05-11：适配云效更新
- 2024-07-09：优化用例挑选
- 2024-10-21：优化导出模式

## 9. 联系方式

作者：娄武剑
如有问题请联系作者 